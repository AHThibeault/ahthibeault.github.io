---
title: 'Power Electronics PV Lab'
date: 2023-05-10
permalink: /posts/pv-lab
tags:
---

## Project Introduction

I took the Power Electronics and Photovoltaic Power Systems Laboratory during my final semester at CU Boulder. I worked together with my lab partner Dane Thorne to complete a series of five experiments in which we designed and constructed a three-stage power electronic system for a standalone PV module. The system involved a singular 85 W PV panel that would deliver DC power to a lead-acid battery via a digitally controlled, maximum-power-point-tracking buck converter, along with a system to deliver standard AC mains power from the battery to a load via a analog controlled cascaded boost converter in series with an H-bridge inverter. We designed and constructed the power electronic modules for the system, and demoed our full working system in the End-of-Semester Lab Exposition. My group came in second out of more than ten groups in the Expo for having the second highest efficiency and resultant power output of our system.

Experiments 1 and 2 dealt with characterizing, simulating, and testing the PV-to-battery stage. If you want to skip ahead to the power converter designs, skip ahead to experiments 3 (buck converter), 4 (boost converter), and 5 (inverter). Please note, I frequently include screenshots from my class reports, which will have different font and formatting, in order to streamline this report.

![Overall System](/images/overallsystem.png)

![Final pic1](/images/finalpic1.jpg)

![Final pic3](/images/finalpic3.jpg)

![Final pic2](/images/finalpic2.jpg)


## Experiment 1: PV-to-battery stage characterization from datasheet specifications and circuit simulation

### Introduction

Experiment 1 involved developing a circuit model for the PV panel from its datasheet characteristics and performing LTspice simulations to determine theoretical operating points of a basic direct transfer scheme and of an open-loop buck converter solution. We also wrote code for the TMS320F28027 Launchpad to generate the PWM signal that would control the buck converter MOSFET switching.

Power from this panel is delivered to a valve-regulated absobent glass mat (VR-AGM) sealed lead-acid battery, intended for deep-discharge solar power system applications. This battery is rated 56 Ah and 12 V, and exhibits the following open-circuit terminal voltages at varying states of charge (SOC):

![battery soc_v](/images/battchar.png)

### PV Panel Equivalent Circuit model

The PV panel we used was the Shell PowerMax Ultra SQ-85P PV panel, which consists of 36 series-connected silicon PV cells. This panel is rated at 85W under standard (STD) test conditions (1000 W/m<sup>2</sup> solar irradiance, 25&deg;C cell temperature), giving 8.5% efficiency. At nominal test conditions (800 W/m<sup>2</sup> irradiance, 24.5&deg;C cell temperature), this panel is rated to output 63 W, giving 12.5% efficiency. The datasheet open circuit voltage (V<sub>OC</sub>), short circuit current (I<sub>SC</sub>), and maximum power point voltage (V<sub>MPP</sub>) and current (I<sub>MPP</sub>) under STD test conditions are as follows: V<sub>OC</sub>=22.2V, I<sub>SC</sub>=5.45A, V<sub>MPP</sub>=17.2V, I<sub>MPP</sub>=4.95A.

![pv panel circuit model](/images/pv_circuit_model.png)

![pv equations](/images/pveqs.png)

Parameters corresponding this circuit model for the Shell Powermax panel were calculated using numerical iteration in a MATLAB script. These parameters were found to be as follows: I<sub>D0</sub>=261.23pA, R<sub>S</sub>=13.06mΩ, R<sub>P</sub>=2.36Ω, k<sub>i</sub>=0.00548.

### LTSpice simulations

#### Standalone panel

![pv simulation](/images/pvsim.png)

![pv simulation2](/images/pvsim2.png)

#### Direct Energy Transfer (DET) scheme

The DET scheme, with the PV panel connected directly to the battery, was simulated with the battery voltage fixed at 12.55 V (75% SOC)

![det sim](/images/detsim.png)

#### Buck Converter Scheme

![buck sim1](/images/bucksim1.png)

![buck sim2](/images/bucksim2.png)

![buck sim3](/images/bucksim3.png)

#### Maximum Power Point Simulations

Transient simulations of the buck converter scheme schematic were run at varying solar insolation values with manually updated converter duty cycle to maximize Pbatt. These duty cycle values were chosen by recalculating for duty cycle given the MPP voltage values found from simulation of the standalone system, the buck output voltage (V<sub>batt</sub>=12.55V), and the transfer function for an ideal buck converter, M(D)=D. The average battery current (Ibatt) and power (Pbatt) were measured at each value of Isolar, along with the converter efficiency values (η). The calculated duty cycles and corresponding simulation results are shown below:

![buck mpp sim](/images/buckmppsim.png)

### Setting up the TMS320F28027 LaunchPad for PWM generation and A/D conversion

The last part of this experiment involved writing C code for the Launchpad to generate a specified duty cycle at 100kHz switching frequency, as well as to perform A/D conversion on an analog voltage (eventually the sensed output voltage of the buck converter). I am not going to go into the details of that code here.

## Experiment 2: Testing and characterizing the PV panel and DET system









